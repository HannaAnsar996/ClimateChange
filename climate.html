<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Climate Change</title>
  <link rel="icon" href="Images/nature.jpg">
  <link rel="stylesheet" type="text/css" href="climate.css">
</head>
<body>

  <!-- Hamburger Menu -->
  <div id="menuIcon" class="no-animation">
    <div class="bar"></div>
    <div class="bar"></div>
    <div class="bar"></div>
  </div>

  <div class="menu-box" id="menuBox">
    <ul>
      <li><a href="index.html">Home</a></li>
      <li><a href="About.html">About</a></li>
      <li><a href="Causes.html">Causes</a></li>
      <li><a href="Prevention.html">Prevention</a></li>
      <li><a href="climate.html">Earth's Pulse</a></li>
      <li><a href="Feedback.html">Feedback</a></li>
    </ul>
  </div>

  <!-- Weather Forecast Section -->
  <div class="weather-container">
    <h2>Live Weather Forecast</h2>
    <div class="search-box">
      <input type="text" placeholder="Enter city name" id="city-input">
      <button id="search-btn" style="width: 150px;">Search</button>
    </div>

    <div class="current-weather">
      <h1 id="city-name">Dubai</h1>
      <img id="weather-icon" src="images/sun.gif" alt="Weather Icon">
      <div class="weather-details">
        <p><strong>Temp:</strong> <span id="temperature">36</span>Â°C</p>
        <p><strong>Humidity:</strong> <span id="humidity">41</span>%</p>
        <p><strong>Wind:</strong> <span id="wind-speed">8.75</span> km/h</p>
      </div>
    </div>

    <div class="forecast" id="forecast-container"></div>
  </div>

  <!-- Carbon Footprint Section -->
  <div class="carbon-container">
    <div class="container">
      <h1>Carbon Footprint Calculator</h1>
      <form id="calculator">
        <label for="electricity">Electricity (kWh/month):</label>
        <input type="number" id="electricity" required style=" width: 470px;">

        <label for="car">Car Travel (km/week):</label>
        <input type="number" id="car" required style=" width: 470px;">

        <label for="flights">Flights (per year):</label>
        <input type="number" id="flights" required style=" width: 470px;">

        <button type="button" onclick="calculateFootprint()">Calculate</button>
      </form>
      <div id="result"></div>
    </div>
  </div>
<div class="tree-game-container">
  <h2>ðŸŒ³ Grow a Tree & Boost Oxygen!</h2>
  <p id="oxygen-level">Oxygen Level: 0%</p>
  <div id="land" class="land"></div>
  <button onclick="resetGame()">Reset</button>
</div>
  <!-- Scripts -->
  <script>
    // Menu toggle
    const menuBox = document.getElementById("menuBox");
    const menuIcon = document.getElementById("menuIcon");

    menuIcon.onclick = function () {
      menuBox.classList.toggle("open-menu");
      menuIcon.classList.toggle("open-menu");
    };

    // Weather fetch
    const apiKey = "f9a6f2cea1e78bf84a00090e1621e721";
    const apiUrlWeather = "https://api.openweathermap.org/data/2.5/weather";
    const apiUrlForecast = "https://api.openweathermap.org/data/2.5/forecast";

    const searchBox = document.querySelector("#city-input");
    const searchBtn = document.querySelector("#search-btn");
    const cityName = document.querySelector("#city-name");
    const weatherIcon = document.querySelector("#weather-icon");
    const temperature = document.querySelector("#temperature");
    const humidity = document.querySelector("#humidity");
    const windSpeed = document.querySelector("#wind-speed");
    const forecastContainer = document.querySelector("#forecast-container");

    async function fetchWeather(city) {
      try {
        const response = await fetch(`${apiUrlWeather}?q=${city}&appid=${apiKey}&units=metric`);
        if (!response.ok) throw new Error("City not found!");
        const data = await response.json();

        cityName.innerText = data.name;
        temperature.innerText = Math.round(data.main.temp);
        humidity.innerText = data.main.humidity;
        windSpeed.innerText = data.wind.speed;

        const weatherCondition = data.weather[0].main.toLowerCase();
        const currentTime = Math.floor(Date.now() / 1000);
        const sunsetTime = data.sys.sunset;
        const isNight = currentTime > sunsetTime;

        const gifMap = {
          "clear": isNight ? "images/moon.gif" : "images/sun.gif",
          "clouds": isNight ? "images/cloudymoon.gif" : "images/cloud.gif",
          "rain": "images/rain.gif",
          "snow": "images/snow.gif",
          "thunderstorm": "images/thunder.gif",
          "wind": "images/windy.gif"
        };

        weatherIcon.src = gifMap[weatherCondition] || "images/default.gif";
      } catch (error) {
        alert(error.message);
      }
    }

    async function fetchForecast(city) {
      try {
        const response = await fetch(`${apiUrlForecast}?q=${city}&appid=${apiKey}&units=metric`);
        if (!response.ok) throw new Error("City not found!");
        const data = await response.json();

        forecastContainer.innerHTML = "";
        let forecastDays = {};

        data.list.forEach(item => {
          const date = item.dt_txt.split(" ")[0];
          const dayName = new Date(date).toLocaleDateString("en-US", { weekday: "long" });

          if (!forecastDays[dayName]) {
            forecastDays[dayName] = {
              temp: Math.round(item.main.temp),
              weather: item.weather[0].main,
              icon: item.weather[0].icon
            };
          }
        });

const forecastGifMap = {
  "Clear": "images/sun.gif",
  "Clouds": "images/cloud.gif",
  "Rain": "images/rain.gif",
  "Snow": "images/snow.gif",
  "Thunderstorm": "images/thunder.gif",
  "Wind": "images/windy.gif"
};

for (const day in forecastDays) {
  forecastContainer.innerHTML += `
    <div class="forecast-day">
      <h3>${day}</h3>
      <img src="${forecastGifMap[forecastDays[day].weather] || 'images/default.gif'}" alt="Weather Icon">
      <p>${forecastDays[day].weather}</p>
      <p>${forecastDays[day].temp}Â°C</p>
    </div>
  `;
}

      } catch (error) {
        alert(error.message);
      }
    }

    searchBtn.addEventListener("click", () => {
      const city = searchBox.value;
      fetchWeather(city);
      fetchForecast(city);
    });

    searchBox.addEventListener("keypress", (e) => {
      if (e.key === "Enter") {
        const city = searchBox.value;
        fetchWeather(city);
        fetchForecast(city);
      }
    });

    // Default on load
    fetchWeather("Dubai");
    fetchForecast("Dubai");

    function calculateFootprint() {
      const electricity = parseFloat(document.getElementById("electricity").value) * 0.5;
      const car = parseFloat(document.getElementById("car").value) * 0.2;
      const flights = parseFloat(document.getElementById("flights").value) * 500;

      if (isNaN(electricity) || isNaN(car) || isNaN(flights)) {
        document.getElementById("result").innerHTML = "Please enter valid values.";
        return;
      }

      const total = electricity + car + flights;
      document.getElementById("result").innerHTML = `Your estimated carbon footprint is <strong>${total.toFixed(2)}</strong> kg COâ‚‚ per year.`;
    }

let oxygen = 0;
const land = document.getElementById("land");
const oxygenText = document.getElementById("oxygen-level");

land.addEventListener("click", function (e) {
  const rect = land.getBoundingClientRect();
  const y = e.clientY - rect.top;

  // Only allow planting in the bottom 40% of the land area
  if (y < rect.height * 0.6) {
    return; // Don't grow a tree in the sky
  }

  const tree = document.createElement("div");
  tree.classList.add("tree");

  const x = e.clientX - rect.left - 25;
  tree.style.left = `${x}px`;
  tree.style.top = `${y - 70}px`; // Adjust tree position above cursor

  land.appendChild(tree);

  oxygen += 2;
  if (oxygen > 100) oxygen = 100;
  oxygenText.innerText = `Oxygen Level: ${oxygen}%`;
});

function resetGame() {
  land.innerHTML = "";
  oxygen = 0;
  oxygenText.innerText = "Oxygen Level: 0%";
}

  </script>
</body>
</html>
